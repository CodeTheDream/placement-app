<!--Update to remove API Key and replace with Rails Credentials-->
<!--Code to load interactive maps begin-->

<% provide :head_tags do %>
  <meta name='turbolinks-visit-control' content='reload'>
    <script>
      document.addEventListener("DOMContentLoaded", function(){
        initMap(<%=@placement.latitude%>, <%=@placement.longitude%>)
      });
    </script>
<% end %>
<!--Code for interactive maps ends-->

<h3 class='page-header'>Placement Details</h3>

<div class='row ml-2 mr-2'>
  
  <div class='col'>
    <div class='shadow-sm card rounded mb-2 mx-auto'>
      <div class='card-body'>
          <h2 class='title'><%= @placement.name %></h2>
          <div>
              <%= link_to 'Add Placement to Cart', add_carts_path(placement_id: @placement.id), method: :post, class: 'btn btn-standard my-2' %>
          </div>
          <ul class='list-group shadow mb-2'>
              <li class='list-group-item'><%= @placement.address %>, <br>
              <%= @placement.city %>, <%= @placement.state %> <%= @placement.zip %> <br>
              <!--<li class='list-group-item'>-->
              <!--    Latitude: < @placement.latitude %> <br>-->
              <!--    Longitude: <= @placement.longitude %> <br>-->
              <!--    Full Address: <=@placement.full_address_1 %>-->
              <!--</li>-->
              County: <%= @placement.county %><br>
              Home Phone: <%= @placement.phone %></li>
              <li class='list-group-item'>
                  Gender: <%= @placement.gender %> <br>
                  Beds: <%= @placement.beds %>
              </li>
          </ul>
      </div>
    </div>

    <div class='shadow-sm card col rounded mb-2 mx-auto'>
      <div class='card-body'>
          <h2 class='title'>Referral Contact</h2>
          <ul class='list-group shadow mb-2'>
              <li class='list-group-item'><%= @licensee.contact_name %></li>
              <li class='list-group-item'>Phone: <%= @licensee.phone %></li>
              <li class='list-group-item'>Fax: <%= @licensee.fax %></li>
          </ul>
   
          <%= link_to 'View Licensee', licensee_path(@placement.licensee_id), class: 'btn btn-standard mt-2' %>
        </div>
      </div>
    </div>

  <div class='col'>
    <div id="map" class='shadow-sm rounded mx-auto'></div>
    
    <div class='shadow-sm card rounded mb-2 mt-2 mx-auto'>
      <div class='card-body'>
        <h2 class= 'title'>License Type</h2>
        <ul>
          <li class='list-group-item'><%= @service.name %></li>
          <li class='list-group-item'><%= @service.prog_code %></li>
        </ul>
      </div>     
    </div>
  </div>
</div>

<h3 class='page-header'>Comments</h3>

<%= render 'new_comment' %>


<% @comments.each do |c| %>
    <div class='shadow-sm card col-6 rounded mb-2 mt-2 mx-auto'>
        <div class='card-body'>
            <ul class='list-group shadow'>
                <li class='list-group-item'><%= c.text %></li>
            </ul>
            <div class='mt-2 text-white'>
                By <%= c.user.first_name %> <%= c.user.last_name %>
                at <%= c.created_at.strftime("%-I:%M %P on %-m/%-d/%y") %><br>
                <% if current_user && current_user.admin? || current_user == c.user %>
                    <%= link_to 'Delete', comment_path(c.id), method: :delete, :data => {:confirm => "Are you sure?"}, class: 'btn btn-danger mr-4' %>
                <% end %>
                <% if current_user && current_user == c.user %>
                    <%= link_to 'Edit', edit_comment_path(c.id), class:'btn btn-standard ml-4' %>
                <% end %>
            </div>
        </div>
    </div>
<% end %>

